All credit for this implementation of the Gale/Shapley algorithm goes to Jon Voigt.
